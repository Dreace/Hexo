<!DOCTYPE html>
<html>

<head>
  
  <title>博客迁移日志其二 使用 Github Actions 自动部署 Hexo - DreaceのBlog</title>
  <meta charset="UTF-8">
  <meta name="description" content="一条咸鱼的垂死挣扎">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  

  <link rel="shortcut icon" href="/images/avatar.png" type="image/png" />
  <meta name="description" content="上一篇博客博客迁移日志其一 从 WordPress 到 Hexo中已经完成将 WordPress 中的数据迁移到 Hexo，但是每次修改内容后都要手动生成静态网页然后同步到服务器，这些步骤还是很繁琐的。因此需要一个自动化的流程来帮助部署博客，GitHub Actions 可以很好的满足这个需求。">
<meta name="keywords" content="Hexo,Github Actions">
<meta property="og:type" content="article">
<meta property="og:title" content="博客迁移日志其二 使用 Github Actions 自动部署 Hexo">
<meta property="og:url" content="https:&#x2F;&#x2F;blog.dreace.top&#x2F;2020&#x2F;Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions&#x2F;index.html">
<meta property="og:site_name" content="DreaceのBlog">
<meta property="og:description" content="上一篇博客博客迁移日志其一 从 WordPress 到 Hexo中已经完成将 WordPress 中的数据迁移到 Hexo，但是每次修改内容后都要手动生成静态网页然后同步到服务器，这些步骤还是很繁琐的。因此需要一个自动化的流程来帮助部署博客，GitHub Actions 可以很好的满足这个需求。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https:&#x2F;&#x2F;blog.dreace.top&#x2F;images&#x2F;Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions&#x2F;image-20200110155500166.png">
<meta property="og:image" content="https:&#x2F;&#x2F;blog.dreace.top&#x2F;images&#x2F;Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions&#x2F;image-20200110155919909.png">
<meta property="og:image" content="https:&#x2F;&#x2F;blog.dreace.top&#x2F;images&#x2F;Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions&#x2F;image-20200110161901448.png">
<meta property="og:updated_time" content="2020-04-15T16:14:49.754Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;blog.dreace.top&#x2F;images&#x2F;Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions&#x2F;image-20200110155500166.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/css/mdui.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.15.8/styles/atom-one-dark.css">
   
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1038733_0xvrvpg9c0r.css">
  <link rel="stylesheet" href="/css/style.css?v=1586967308831">
<link rel="alternate" href="/atom.xml" title="DreaceのBlog" type="application/atom+xml">
</head>

<body class="mdui-drawer-body-left">
  
  <div id="nexmoe-background">
    <div class="nexmoe-bg" style="background-image: url()"></div>
    <div class="mdui-appbar mdui-shadow-0">
      <div class="mdui-toolbar">
        <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">menu</i></a>
        <div class="mdui-toolbar-spacer"></div>
        <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
        <a href="/" title="Dreace" class="mdui-btn mdui-btn-icon"><img src="/images/avatar.png"></a>
       </div>
    </div>
  </div>
  <div id="nexmoe-header">
      <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Dreace">
            <img src="/images/avatar.png" alt="Dreace">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>10</div>
        <div><span>标签</span>23</div>
        <div><span>分类</span>5</div>
    </div>
    <ul class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/archives" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/friends.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </ul>
    <aside id="nexmoe-sidebar">
  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章目录</h3>
    <div class="nexmoe-widget">
      <div id="toc" class="toc-article">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#配置目标服务器"><span class="toc-text">配置目标服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#x01-安装-git1"><span class="toc-text">0x01 安装 Git1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x02-创建新用户"><span class="toc-text">0x02 创建新用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x03-生成-ssh-密钥2"><span class="toc-text">0x03 生成 SSH 密钥2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x04-复制-ssh-密钥"><span class="toc-text">0x04 复制 SSH 密钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x05-创建裸仓库"><span class="toc-text">0x05 创建裸仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x06-创建存放静态网页目录"><span class="toc-text">0x06 创建存放静态网页目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x07-配置-git-钩子"><span class="toc-text">0x07 配置 Git 钩子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x08-更改仓库目录所有者"><span class="toc-text">0x08 更改仓库目录所有者</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x09-禁止-git-用户登录-shell"><span class="toc-text">0x09 禁止 git 用户登录 shell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置-github-actions"><span class="toc-text">配置 GitHub Actions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#x01-添加私钥到-github-仓库"><span class="toc-text">0x01 添加私钥到 GitHub 仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x02-添加-github-actions"><span class="toc-text">0x02 添加 GitHub Actions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置-hexo"><span class="toc-text">配置 Hexo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置-nginx"><span class="toc-text">配置 Nginx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#测试"><span class="toc-text">测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最后"><span class="toc-text">最后</span></a></li></ol>
      </div>
    </div>
  </div>


  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">联系我</h3>
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://space.bilibili.com/7686754" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/Dreace233" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a><a class="mdui-ripple" href="https://www.zhihu.com/people/ni-xiang-42-96/activities" target="_blank" mdui-tooltip="{content: '知乎'}" style="color: rgb(30, 136, 229);background-color: rgba(30, 136, 229, .15);">
            <i class="nexmoefont icon-zhihu"></i>
        </a><a class="mdui-ripple" href="https://twitter.com/Dreace520" target="_blank" mdui-tooltip="{content: 'Twitter'}" style="color: rgb(29, 161, 242);background-color: rgba(29, 161, 242, .15);">
            <i class="nexmoefont icon-twitter"></i>
        </a><a class="mdui-ripple" href="https://steamcommunity.com/id/Dreace_Dreace/" target="_blank" mdui-tooltip="{content: 'Steam'}" style="color: rgb(37, 116, 196);background-color: rgba(37, 116, 196, .15);">
            <i class="nexmoefont icon-steam"></i>
        </a>
    </div>
</div>
  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/MySQL/">MySQL</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Python/">Python</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Vue-js/">Vue.js</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Windows/">Windows</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/建设日志/">建设日志</a>
          <span class="category-list-count">2</span>
        </li>

        
      </ul>

    </div>
  </div>


  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">标签</h3>
    <div id="randomtagcloud" class="nexmoe-widget tagcloud">
      <a href="/tags/DNS/" style="font-size: 10px;">DNS</a> <a href="/tags/Electron/" style="font-size: 10px;">Electron</a> <a href="/tags/Github-Actions/" style="font-size: 10px;">Github Actions</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/SQL/" style="font-size: 10px;">SQL</a> <a href="/tags/VS-Code/" style="font-size: 10px;">VS Code</a> <a href="/tags/Vue-js/" style="font-size: 10px;">Vue.js</a> <a href="/tags/Windows/" style="font-size: 20px;">Windows</a> <a href="/tags/macOS/" style="font-size: 10px;">macOS</a> <a href="/tags/%E5%85%A5%E9%97%A8/" style="font-size: 10px;">入门</a> <a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 10px;">博客</a> <a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 10px;">教程</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 10px;">数据库</a> <a href="/tags/%E6%A1%8C%E9%9D%A2%E7%AB%AF/" style="font-size: 10px;">桌面端</a> <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 10px;">正则表达式</a> <a href="/tags/%E6%B3%A8%E5%86%8C%E8%A1%A8/" style="font-size: 10px;">注册表</a> <a href="/tags/%E7%BC%96%E7%A8%8B/" style="font-size: 10px;">编程</a> <a href="/tags/%E8%AE%B0%E5%BD%95/" style="font-size: 10px;">记录</a> <a href="/tags/%E8%B7%A8%E5%B9%B3%E5%8F%B0/" style="font-size: 10px;">跨平台</a> <a href="/tags/%E8%BF%81%E7%A7%BB/" style="font-size: 10px;">迁移</a>
    </div>
    
      <script>
        var maxTagcloud = parseInt(10);
        var tags_length = parseInt(23);
        var tags_arr = [];
        for(var i = 0; i < tags_length; i++){
          tags_arr.push(i);
        }
        tags_arr.sort(function (l, r) {
          return Math.random() > 0.5 ? -1 : 1;
        });
        tags_arr = tags_arr.slice(0, maxTagcloud < tags_length ? tags_length - maxTagcloud : 0);
        for(var tag_i = 0; tag_i < tags_arr.length; tag_i++){
          document.getElementById("randomtagcloud").children[tags_arr[tag_i]].style.display = 'none';
        }
      </script>
    
  </div>

  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li></ul>
    </div>
  </div>


  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">最新文章</h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2020/DNS-Resolution-is-Slow-on-Windows-but-nslookup-is-Normal/">Windows 上 DNS 解析慢，但 nslookup 正常</a>
          </li>
        
          <li>
            <a href="/2020/MySQL-Multiple-Keyword-Matching/">MySQL 多关键词匹配</a>
          </li>
        
          <li>
            <a href="/2020/Solve-An-operation-on-a-socket-could-not-be-performed-because-the-system-lacked-sufficient-buffer-space-or-because-a-queue-was-full/">解决“由于系统缓冲区空间不足或队列已满，不能执行套接字上的操作”</a>
          </li>
        
          <li>
            <a href="/2020/Electron-Vue-js-for-Desktop-Cross-platform-Application-1-Environment-Setup/">Electron + Vue.js 打造桌面端跨平台应用#1 环境搭建</a>
          </li>
        
          <li>
            <a href="/2020/Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions/">博客迁移日志其二 使用 Github Actions 自动部署 Hexo</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
    <div class="nexmoe-copyright">
        &copy; 2020 Dreace<br>
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://nexmoe.com/hexo-theme-nexmoe.html" target="_blank">Nexmoe</a>
    </div>
</div><!-- .nexmoe-drawer -->
  </div>
  <div id="nexmoe-content">
    <div class="nexmoe-primary">
        <div class="nexmoe-post">
    <div class="nexmoe-post-cover"> 

        <h1>博客迁移日志其二 使用 Github Actions 自动部署 Hexo</h1>
    </div>
  <div class="nexmoe-post-meta">
    <a><i class="nexmoefont icon-calendar-fill"></i>2020年01月10日</a>
    <a><i class="nexmoefont icon-areachart"></i>1.3k 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 7 分钟</a>
    
      <a class="nexmoefont icon-appstore-fill -link" href="/categories/%E5%BB%BA%E8%AE%BE%E6%97%A5%E5%BF%97/">建设日志</a>
    
    
      <a class="nexmoefont icon-tag-fill -link" href="/tags/Github-Actions/" rel="tag">Github Actions</a> <a class="nexmoefont icon-tag-fill -link" href="/tags/Hexo/" rel="tag">Hexo</a>
    
  </div>
  <article>
    <p>&#x4E0A;&#x4E00;&#x7BC7;&#x535A;&#x5BA2;<a href="/2019/Blog-Transfer-Record-1-From-WordPress-to-Hexo/" title="&#x535A;&#x5BA2;&#x8FC1;&#x79FB;&#x65E5;&#x5FD7;&#x5176;&#x4E00; &#x4ECE; WordPress &#x5230; Hexo">&#x535A;&#x5BA2;&#x8FC1;&#x79FB;&#x65E5;&#x5FD7;&#x5176;&#x4E00; &#x4ECE; WordPress &#x5230; Hexo</a>&#x4E2D;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x5C06; WordPress &#x4E2D;&#x7684;&#x6570;&#x636E;&#x8FC1;&#x79FB;&#x5230; Hexo&#xFF0C;&#x4F46;&#x662F;&#x6BCF;&#x6B21;&#x4FEE;&#x6539;&#x5185;&#x5BB9;&#x540E;&#x90FD;&#x8981;&#x624B;&#x52A8;&#x751F;&#x6210;&#x9759;&#x6001;&#x7F51;&#x9875;&#x7136;&#x540E;&#x540C;&#x6B65;&#x5230;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x8FD9;&#x4E9B;&#x6B65;&#x9AA4;&#x8FD8;&#x662F;&#x5F88;&#x7E41;&#x7410;&#x7684;&#x3002;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x81EA;&#x52A8;&#x5316;&#x7684;&#x6D41;&#x7A0B;&#x6765;&#x5E2E;&#x52A9;&#x90E8;&#x7F72;&#x535A;&#x5BA2;&#xFF0C;<a href="https://github.com/features/actions" target="_blank" rel="noopener">GitHub Actions</a> &#x53EF;&#x4EE5;&#x5F88;&#x597D;&#x7684;&#x6EE1;&#x8DB3;&#x8FD9;&#x4E2A;&#x9700;&#x6C42;&#x3002;</p>
<a id="more"></a>
<h2 id="&#x914D;&#x7F6E;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x5668;">&#x914D;&#x7F6E;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x5668;</h2>
<p>&#x5728;&#x5F00;&#x59CB;&#x524D;&#x9700;&#x8981;&#x5728;&#x90E8;&#x7F72; Hexo &#x7684;&#x670D;&#x52A1;&#x5668;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x7A7A;&#x7684; Git &#x4ED3;&#x5E93;&#xFF0C;&#x4EE5;&#x53CA;&#x8BBE;&#x7F6E;&#x901A;&#x8FC7;&#x79C1;&#x94A5;&#x767B;&#x5F55;&#x3002;&#x4EE5;&#x4E0B;&#x4F7F;&#x7528;&#x7684;&#x547D;&#x4EE4;&#x4EE5; CentOS &#x4E3A;&#x4F8B;&#xFF0C;&#x5176;&#x4ED6; Linux &#x7248;&#x672C;&#x540C;&#x7406;&#x3002;</p>
<h3 id="x01-&#x5B89;&#x88C5;-git1">0x01 &#x5B89;&#x88C5; Git<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></h3>
<p>&#x76F4;&#x63A5;&#x5B89;&#x88C5;&#xFF1A;</p>
<pre><code>sudo yum install git</code></pre>
<h3 id="x02-&#x521B;&#x5EFA;&#x65B0;&#x7528;&#x6237;">0x02 &#x521B;&#x5EFA;&#x65B0;&#x7528;&#x6237;</h3>
<p>&#x4E3A;&#x4E86;&#x63A7;&#x5236;&#x6743;&#x9650;&#xFF0C;&#x53EF;&#x65B0;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x540D;&#x4E3A; git &#x7684;&#x7528;&#x6237;&#xFF1A;</p>
<pre><code>sudo adduser git</code></pre>
<h3 id="x03-&#x751F;&#x6210;-ssh-&#x5BC6;&#x94A5;2">0x03 &#x751F;&#x6210; SSH &#x5BC6;&#x94A5;<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></h3>
<p>SSH &#x5BC6;&#x94A5;&#x7528;&#x4E8E;&#x90E8;&#x7F72;&#x65F6;&#x514D;&#x5BC6;&#x767B;&#x5F55;&#x3002;&#x4F7F;&#x7528; <code>ssh-keygen</code> &#x751F;&#x6210;&#x5BC6;&#x94A5;&#xFF0C;&#x6CE8;&#x610F;&#x5C06; <code>your_email@example.com</code> &#x66FF;&#x6362;&#x6210;&#x81EA;&#x5DF1;&#x7684;&#x90AE;&#x7BB1;&#x3002;</p>
<pre><code>ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;</code></pre>
<p>&#x8BE2;&#x95EE;&#x5B58;&#x653E;&#x4F4D;&#x7F6E;&#xFF1A;</p>
<pre><code>Enter file in which to save the key (/root/.ssh/id_rsa): </code></pre>
<p>&#x76F4;&#x63A5;&#x56DE;&#x8F66;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;&#x5373;&#x53EF;&#xFF08;<code>/root/.ssh/id_rsa</code>&#xFF09;&#x3002;</p>
<p>&#x63D0;&#x793A;&#x8F93;&#x5165;&#x5BC6;&#x7801;&#xFF1A;</p>
<pre><code>Enter passphrase (empty for no passphrase): 
Enter same passphrase again: </code></pre>
<p>&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x5BC6;&#x7801;&#x5E76;&#x91CD;&#x590D;&#xFF0C;&#x76F4;&#x63A5;&#x56DE;&#x8F66;&#x8868;&#x793A;&#x5BC6;&#x7801;&#x7559;&#x7A7A;&#x3002;</p>
<h3 id="x04-&#x590D;&#x5236;-ssh-&#x5BC6;&#x94A5;">0x04 &#x590D;&#x5236; SSH &#x5BC6;&#x94A5;</h3>
<p>&#x5C06; <code>~/.ssh/id_rsa.pub</code> &#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x6DFB;&#x52A0;&#x5230; <code>/home/git/.ssh/authorized_keys</code> &#x4E2D;&#xFF0C;&#x82E5;&#x8BE5;&#x6587;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&#x53EF;&#x4EE5;&#x624B;&#x52A8;&#x521B;&#x5EFA;&#x3002;</p>
<h3 id="x05-&#x521B;&#x5EFA;&#x88F8;&#x4ED3;&#x5E93;">0x05 &#x521B;&#x5EFA;&#x88F8;&#x4ED3;&#x5E93;</h3>
<p>&#x5728; <code>/var/repo</code> &#x65B0;&#x5EFA;&#x540D;&#x4E3A; <code>blog.git</code> &#x7684;&#x4ED3;&#x5E93;&#xFF1A;</p>
<pre><code>sudo mkdir /var/repo
cd /var/repo
sudo git init --bare blog.git</code></pre>
<p>&#x88F8;&#x4ED3;&#x5E93;&#x6CA1;&#x6709;&#x5DE5;&#x4F5C;&#x533A;&#xFF0C;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x5171;&#x4EAB;&#x3002;</p>
<h3 id="x06-&#x521B;&#x5EFA;&#x5B58;&#x653E;&#x9759;&#x6001;&#x7F51;&#x9875;&#x76EE;&#x5F55;">0x06 &#x521B;&#x5EFA;&#x5B58;&#x653E;&#x9759;&#x6001;&#x7F51;&#x9875;&#x76EE;&#x5F55;</h3>
<p>&#x521B;&#x5EFA;&#x76EE;&#x5F55;&#xFF1A;</p>
<pre><code>cd /var/
sudo mkdir www
cd www
sudo mkdir html
cd html
sudo mkdir hexo</code></pre>
<p>&#x4EE5;&#x540E;&#x751F;&#x6210;&#x7684;&#x6587;&#x4EF6;&#x5C06;&#x5B58;&#x653E;&#x5728; <code>/var/www/html/hexo</code> &#x4E0B;&#x3002;</p>
<p>&#x66F4;&#x6539;&#x6743;&#x9650;&#xFF1A;</p>
<pre><code>cd /var/
sudo chmod -R 777 www
cd www
sudo chmod -R 777 html
cd html
sudo chmod -R 777 hexo</code></pre>
<h3 id="x07-&#x914D;&#x7F6E;-git-&#x94A9;&#x5B50;">0x07 &#x914D;&#x7F6E; Git &#x94A9;&#x5B50;</h3>
<p>&#x8FDB;&#x5165; <code>/var/repo/blog.git/hooks</code>&#xFF0C;&#x521B;&#x5EFA;&#x7F16;&#x8F91; <code>post-receive</code> &#x6587;&#x4EF6;&#xFF1A;</p>
<pre><code>cd /var/repo/blog.git/hooks
sudo vim post-receive</code></pre>
<p>&#x5728; <code>post-receive</code> &#x5199;&#x5165;&#xFF1A;</p>
<pre><code>git --work-tree=/var/www/html/hexo --git-dir=/var/repo/blog.git checkout -f</code></pre>
<p>&#x8868;&#x793A;&#x6BCF;&#x6B21; <code>push</code> &#x662F;&#x6587;&#x4EF6;&#x5C06;&#x5B58;&#x653E;&#x5728; <code>/var/www/html/hexo</code> &#x4E0B;&#x3002;</p>
<p>&#x4FDD;&#x5B58;&#x540E;&#x8D4B;&#x4E88; <code>post-receive</code> &#x53EF;&#x6267;&#x884C;&#x6743;&#x9650;&#xFF1A;</p>
<pre><code>chmod +x post-receive</code></pre>
<h3 id="x08-&#x66F4;&#x6539;&#x4ED3;&#x5E93;&#x76EE;&#x5F55;&#x6240;&#x6709;&#x8005;">0x08 &#x66F4;&#x6539;&#x4ED3;&#x5E93;&#x76EE;&#x5F55;&#x6240;&#x6709;&#x8005;</h3>
<p>&#x5C06; <code>blog.git</code> &#x76EE;&#x5F55;&#x7684;&#x6240;&#x6709;&#x8005;&#x66F4;&#x6539;&#x4E3A; git &#x7528;&#x6237;&#xFF1A;</p>
<pre><code>sudo chown -R git:git blog.git</code></pre>
<h3 id="x09-&#x7981;&#x6B62;-git-&#x7528;&#x6237;&#x767B;&#x5F55;-shell">0x09 &#x7981;&#x6B62; git &#x7528;&#x6237;&#x767B;&#x5F55; shell</h3>
<p>&#x7F16;&#x8F91; <code>/etc/passwd</code>&#xFF0C;&#x627E;&#x5230;</p>
<pre><code>git:x:1001:1001:git,,,:/home/git:/bin/bash</code></pre>
<p>&#x4FEE;&#x6539;&#x4E3A;&#xFF1A;</p>
<pre><code>git:x:1001:1001:,,,:/home/git:/usr/bin/git-shell</code></pre>
<p>&#x8FD9;&#x6837; git &#x7528;&#x6237;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; SSH &#x4F7F;&#x7528; git&#xFF0C;&#x4F46;&#x4E0D;&#x80FD;&#x4F7F;&#x7528; shell&#x3002;</p>
<h2 id="&#x914D;&#x7F6E;-github-actions">&#x914D;&#x7F6E; GitHub Actions</h2>
<h3 id="x01-&#x6DFB;&#x52A0;&#x79C1;&#x94A5;&#x5230;-github-&#x4ED3;&#x5E93;">0x01 &#x6DFB;&#x52A0;&#x79C1;&#x94A5;&#x5230; GitHub &#x4ED3;&#x5E93;</h3>
<p>&#x5982;&#x679C;&#x5B58;&#x653E; Hexo &#x6E90;&#x6587;&#x4EF6;&#x7684;&#x4ED3;&#x5E93;&#x662F;&#x516C;&#x5F00;&#x7684;&#xFF0C;&#x4E3A;&#x4E86;&#x4E0D;&#x66B4;&#x9732;&#x79C1;&#x94A5;&#x9700;&#x8981;&#x5C06;&#x4E4B;&#x524D;&#x751F;&#x6210;&#x7684;&#x79C1;&#x94A5;&#x4FDD;&#x5B58;&#x5230; <code>Secrets</code> &#x5F53;&#x4E2D;&#xFF0C;&#x9700;&#x8981;&#x65F6;&#x901A;&#x8FC7;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x8BBF;&#x95EE;&#x3002;</p>
<figure>
<img src="/images/Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions/image-20200110155500166.png" alt><figcaption>&#x6DFB;&#x52A0; Secrets</figcaption>
</figure>
<p><code>Name</code> &#x586B;&#x5199;&#x4E3A; <code>id_rsa</code>&#xFF0C; <code>Value</code> &#x4E2D;&#x586B;&#x5199;&#x4E4B;&#x524D;&#x751F;&#x6210;&#x7684; <code>id_rsa</code> &#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5F62;&#x5982;&#xFF1A;</p>
<pre><code>-----BEGIN RSA PRIVATE KEY-----
MIIJKQIBAAKCAgEAq0XtV523Wcgs/2DqFAxqicbHb4x0tvwt/mNe7pKBCLzkL551
DyCHEYVoOVUbO3Fu80h5M7Ku4+ojWSZpCXwqabObTn1tTNUrubWi2OIfkqnzGn+T
...
6FEmudj4Bb1+GZPu7muNWYamydlCK8D7cAu6I/iRyC0ya5j9wDZpYXYr2fRzd4Hf
rsTNxNy45COZWr7IBbrb0+WBXlXwTrSx+XioRxEyukk1U79aIk3uvSP6C/4F
-----END RSA PRIVATE KEY-----</code></pre>
<h3 id="x02-&#x6DFB;&#x52A0;-github-actions">0x02 &#x6DFB;&#x52A0; GitHub Actions</h3>
<p>&#x9996;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF1A;</p>
<figure>
<img src="/images/Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions/image-20200110155919909.png" alt><figcaption>&#x65B0;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</figcaption>
</figure>
<p>&#x5199;&#x5165;<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>&#xFF1A;</p>
<pre><code>name: Node CI

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [10.x]

    steps:
      - uses: actions/checkout@v1
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v1
        with:
          node-version: ${{ matrix.node-version }}
      - name: Configuration environment
        env:
          ID_RSA: ${{secrets.id_rsa}}
        run: |
          mkdir -p ~/.ssh/
          echo &quot;$ID_RSA&quot; &gt; ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan &lt;your_host&gt; &gt;&gt; ~/.ssh/known_hosts
          git config --global user.name &apos;&lt;your_user_name&gt;&apos;
          git config --global user.email &apos;&lt;your_email&gt;&apos;
      - name: Install dependencies
        run: |
          npm i -g hexo-cli
          npm i
      - name: Deploy hexo
        run: |
          hexo g -d</code></pre>
<p>&#x6CE8;&#x610F;&#x5C06; <code>&lt;your_host&gt;</code>&#x3001;<code>&lt;your_user_name&gt;</code>&#x3001;<code>&lt;your_email&gt;</code> &#x66FF;&#x6362;&#x6210;&#x81EA;&#x5DF1;&#x7684;&#x57DF;&#x540D;&#x3001;&#x7528;&#x6237;&#x540D;&#x548C;&#x90AE;&#x7BB1;&#x3002;</p>
<h2 id="&#x914D;&#x7F6E;-hexo">&#x914D;&#x7F6E; Hexo</h2>
<p>&#x4FEE;&#x6539; Hexo &#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x7684; <code>_config.yml</code> &#x6587;&#x4EF6;&#xFF0C;&#x6DFB;&#x52A0;&#xFF1A;</p>
<pre><code>deploy:
  type: git
  repo: git@&lt;your_host&gt;:/var/repo/blog.git
  ranch: master</code></pre>
<p>&#x5C06; <code>&lt;your_host&gt;</code> &#x66FF;&#x6362;&#x6210;&#x81EA;&#x5DF1;&#x7684;&#x57DF;&#x540D;&#x3002;</p>
<p>&#x6700;&#x540E;&#x522B;&#x5FD8;&#x4E86;&#x5B89;&#x88C5; <a href="https://github.com/hexojs/hexo-deployer-git" target="_blank" rel="noopener">hexo-deployer-git</a> &#x63D2;&#x4EF6;<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>&#x3002;</p>
<pre class="shell"><code>npm install hexo-deployer-git --save</code></pre>
<h2 id="&#x914D;&#x7F6E;-nginx">&#x914D;&#x7F6E; Nginx</h2>
<p>&#x5728; <code>/etc/nginx/conf.d</code> &#x4E0B;&#x65B0;&#x589E;&#x914D;&#x7F6E; <code>blog.conf</code>&#x3002;</p>
<pre><code>server {
    listen 443 ssl;
    server_name &lt;your_host&gt;;
    index index.html;  
    location / {
        root &quot;/var/www/html/hexo&quot;;
    }
}
server {
    listen 80;
    server_name &lt;your_host&gt;;
    rewrite ^(.*) https://$host$1 permanent;
}</code></pre>
<p>&#x5C06; <code>&lt;your_host&gt;</code> &#x66FF;&#x6362;&#x6210;&#x81EA;&#x5DF1;&#x7684;&#x57DF;&#x540D;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x914D;&#x7F6E; SSL&#xFF0C;<code>blog.conf</code> &#x5E94;&#x8BE5;&#x5199;&#x5165;&#xFF1A;</p>
<pre><code>server {
    listen 80;
    server_name &lt;your_host&gt;;
    index index.html;  
    location / {
        root &quot;/var/www/html/hexo&quot;;
    }
}</code></pre>
<h2 id="&#x6D4B;&#x8BD5;">&#x6D4B;&#x8BD5;</h2>
<p>&#x5C06;&#x672C;&#x5730;&#x6587;&#x4EF6;&#x63A8;&#x9001;&#x81F3;&#x8FDC;&#x7A0B;&#x4ED3;&#x5E93;&#xFF0C;&#x53EF;&#x4EE5;&#x5728; Actions &#x9009;&#x9879;&#x4E0B;&#x770B;&#x5230;&#x89E6;&#x53D1;&#x4E86;&#x4E00;&#x6B21; GitHub Actions&#x3002;</p>
<figure>
<img src="/images/Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions/image-20200110161901448.png" alt><figcaption>Actions &#x6267;&#x884C;&#x6210;&#x529F;</figcaption>
</figure>
<h2 id="&#x6700;&#x540E;">&#x6700;&#x540E;</h2>
<p>&#x7136;&#x540E;&#x91CD;&#x542F; Nginx &#x5373;&#x53EF;&#x901A;&#x8FC7; <code>&lt;your_host&gt;</code> &#x8BBF;&#x95EE;&#x535A;&#x5BA2;&#x3002;</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn1" role="doc-endnote"><p><a href="https://calton007.github.io/2018/05/08/n-deploy-vps/" target="_blank" rel="noopener">https://calton007.github.io/2018/05/08/n-deploy-vps/</a> &quot;&#x4F7F;&#x7528; Git Hook &#x81EA;&#x52A8;&#x90E8;&#x7F72; Hexo &#x5230;&#x4E2A;&#x4EBA; VPS&quot;<a href="#fnref1" class="footnote-back" role="doc-backlink">&#x21A9;&#xFE0E;</a></p></li>
<li id="fn2" role="doc-endnote"><p><a href="https://help.github.com/en/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent" target="_blank" rel="noopener">https://help.github.com/en/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent</a> &quot;Generating a new SSH key and adding it to the ssh-agent&quot;<a href="#fnref2" class="footnote-back" role="doc-backlink">&#x21A9;&#xFE0E;</a></p></li>
<li id="fn3" role="doc-endnote"><p><a href="https://suikastar.com/posts/24967/" target="_blank" rel="noopener">https://suikastar.com/posts/24967/</a> &quot;&#x4F7F;&#x7528; GitHub Actions &#x81EA;&#x52A8;&#x5316;&#x90E8;&#x7F72; Hexo&quot;<a href="#fnref3" class="footnote-back" role="doc-backlink">&#x21A9;&#xFE0E;</a></p></li>
<li id="fn4" role="doc-endnote"><p><a href="https://hexo.io/zh-cn/docs/one-command-deployment.html" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/one-command-deployment.html</a> &quot;&#x90E8;&#x7F72;&quot;<a href="#fnref4" class="footnote-back" role="doc-backlink">&#x21A9;&#xFE0E;</a></p></li>
</ol>
</section>

  </article>
  
    
<div class="nexmoe-post-copyright">
<i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
<strong>本文作者：</strong>Dreace<br>
<strong>本文链接：</strong><a href="https://blog.dreace.top/2020/Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions/" title="https:&#x2F;&#x2F;blog.dreace.top&#x2F;2020&#x2F;Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions&#x2F;" target="_blank" rel="noopener">https:&#x2F;&#x2F;blog.dreace.top&#x2F;2020&#x2F;Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions&#x2F;</a><br>

  <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可

</div>


  
  <section class="nexmoe-comment">
    <!-- Unpkg -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@1.2.5/dist/disqusjs.min.css">
<script src="https://cdn.jsdelivr.net/npm/disqusjs@1.2.5/dist/disqus.min.js"></script>
<div id="disqus_thread"></div>
<script>
var dsqjs = new DisqusJS({
    shortname: 'dreace',
    siteName: 'DreaceのBlog',
    identifier: 'https://blog.dreace.top/2020/Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions/',
    url: 'https://blog.dreace.top/2020/Blog-Transfer-Record-2-Automate-Hexo-Deployment-with-GitHub-Actions/',
    title: '博客迁移日志其二 使用 Github Actions 自动部署 Hexo',
    api: 'https://disqus.dreace.top/api/',
    apikey: 'wWzaLh1lIGm4TQtRW4PdoHfZtFBQE4bk7srIXB2J7zRbjZdsLXcboiHY0qHloPgs,1OH6IP9AXbWa1lfMZfSJJCPiCEXUIk9GlNtTTuZ3iJQKyzdwvoWBYrfUm9hIlRDn'.split(","),
    admin: 'Dreace233',
    adminLabel: '书记！'
});
</script>
</section>
</div>
        
    <div class="beian" >
        
            <a class="link" href="http://www.beian.miit.gov.cn/" target="_blank">蜀ICP备17035453号-1</a>
        
        
            &nbsp;&nbsp;&nbsp;&nbsp;<a class="link" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=51202202000022" target="_blank"><i class="govimg"></i>川公网安备 51202202000022号</a>
        
    </div>


    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/mdui@0.4.3/dist/js/mdui.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
 
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>




<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="/js/app.js?v=1586967308839"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.1.0/lazysizes.min.js"></script>


  



    <!-- Tencent Analytics -->
<script>
    (function() {
        var hm = document.createElement("script");
        hm.src = "//tajs.qq.com/stats?sId=500701683";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>



</body>

</html>
